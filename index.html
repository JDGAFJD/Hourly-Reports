<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Agent Chat Logging Form</title>
  <!-- Bootstrap CSS -->
  <link 
    href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" 
    rel="stylesheet"
  />
  <style>
    /* Some custom animations and hover effects */
    .hover-animate:hover {
      transform: scale(1.02);
      transition: all 0.3s ease;
      box-shadow: 0 8px 20px rgba(0, 0, 0, 0.1);
    }
    .fade-in {
      animation: fadeIn 1s ease-in-out;
    }
    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }

    /* Smooth scroll behavior */
    html {
      scroll-behavior: smooth;
    }
  </style>
</head>
<body class="bg-light">

  <div class="container my-5">

    <h1 class="mb-4 text-center">Agent Chat Logging Form</h1>
    <p class="text-center">Please fill out the form below. Your response will be recorded in Google Sheets.</p>

    <!-- FORM START -->
    <form id="chatForm" class="p-4 bg-white rounded hover-animate">
      <!-- Agent Name -->
      <div class="mb-3">
        <label for="agentName" class="form-label fw-bold">Name of the Agent</label>
        <select class="form-select" name="agentName" id="agentName" required>
          <option value="">-- Select Agent --</option>
          <option value="Agent A">Agent A</option>
          <option value="Agent B">Agent B</option>
          <option value="Agent C">Agent C</option>
          <option value="Agent D">Agent D</option>
          <option value="Agent E">Agent E</option>
          <option value="Agent F">Agent F</option>
          <option value="Agent G">Agent G</option>
          <option value="Agent H">Agent H</option>
        </select>
      </div>

      <!-- Date & Hour (CST) -->
      <div class="mb-3">
        <label for="dateHour" class="form-label fw-bold">Date and Hour (CST)</label>
        <input 
          type="datetime-local" 
          class="form-control" 
          name="dateHour" 
          id="dateHour" 
          required
        >
      </div>

      <!-- Total Number of Chats -->
      <div class="mb-3">
        <label for="totalChats" class="form-label fw-bold">Total Number of Chats</label>
        <input 
          type="number" 
          class="form-control" 
          name="totalChats" 
          id="totalChats" 
          required
        >
      </div>

      <hr class="my-4">

      <!-- 1st Category: Billing -->
      <h5 class="mb-3">1) Billing</h5>
      <div class="mb-3">
        <label for="billingTotal" class="form-label fw-bold">Billing Total Chats</label>
        <input 
          type="number" 
          class="form-control" 
          name="billingTotal" 
          id="billingTotal"
        >
      </div>

      <div class="row g-3">
        <div class="col-md-6">
          <label for="chargedAfterCancelation" class="form-label">Charged after cancelation</label>
          <input 
            type="number" 
            class="form-control" 
            name="chargedAfterCancelation"
            id="chargedAfterCancelation"
          >
        </div>
        <div class="col-md-6">
          <label for="with14DaysMBG" class="form-label">With 14 days MBG</label>
          <input 
            type="number" 
            class="form-control" 
            name="with14DaysMBG"
            id="with14DaysMBG"
          >
        </div>
        <div class="col-md-6">
          <label for="addOnsExtraCharges" class="form-label">Add-ons/extra charges</label>
          <input 
            type="number" 
            class="form-control"
            name="addOnsExtraCharges" 
            id="addOnsExtraCharges"
          >
        </div>
        <div class="col-md-6">
          <label for="wantingToPayBill" class="form-label">Wanting to pay their bill</label>
          <input 
            type="number" 
            class="form-control" 
            name="wantingToPayBill"
            id="wantingToPayBill"
          >
        </div>
        <div class="col-md-6">
          <label for="extensions" class="form-label">Extensions</label>
          <input 
            type="number" 
            class="form-control" 
            name="extensions"
            id="extensions"
          >
        </div>
      </div>

      <hr class="my-4">

      <!-- 2nd Category: Tech -->
      <h5 class="mb-3">2) Tech</h5>
      <div class="mb-3">
        <label for="techTotal" class="form-label fw-bold">Tech Total Chats</label>
        <input 
          type="number" 
          class="form-control" 
          name="techTotal" 
          id="techTotal"
        >
      </div>

      <div class="row g-3">
        <div class="col-md-6">
          <label for="activation" class="form-label">Activation</label>
          <input 
            type="number" 
            class="form-control" 
            name="activation"
            id="activation"
          >
        </div>
        <div class="col-md-6">
          <label for="slowSpeeds" class="form-label">Slow speeds</label>
          <input 
            type="number" 
            class="form-control"
            name="slowSpeeds" 
            id="slowSpeeds"
          >
        </div>
        <div class="col-md-6">
          <label for="internetStopping" class="form-label">Internet stopping out of nowhere</label>
          <input 
            type="number" 
            class="form-control"
            name="internetStopping" 
            id="internetStopping"
          >
        </div>
        <div class="col-md-6">
          <label for="notWorkingAfterResume" class="form-label">Internet not working after resuming service</label>
          <input 
            type="number" 
            class="form-control"
            name="notWorkingAfterResume" 
            id="notWorkingAfterResume"
          >
        </div>
        <div class="col-md-6">
          <label for="replacements" class="form-label">Replacements (replacement activation)</label>
          <input 
            type="number" 
            class="form-control"
            name="replacements" 
            id="replacements"
          >
        </div>
      </div>

      <hr class="my-4">

      <!-- 3rd Category: Cancelation -->
      <h5 class="mb-3">3) Cancelation</h5>
      <div class="mb-3">
        <label for="cancelTotal" class="form-label fw-bold">Cancelation Total Chats</label>
        <input 
          type="number" 
          class="form-control" 
          name="cancelTotal" 
          id="cancelTotal"
        >
      </div>

      <div class="row g-3">
        <div class="col-md-6">
          <label for="foundAnother" class="form-label">Found another provider</label>
          <input 
            type="number" 
            class="form-control"
            name="foundAnother"
            id="foundAnother"
          >
        </div>
        <div class="col-md-6">
          <label for="slowSpeedsCancel" class="form-label">Slow speeds</label>
          <input 
            type="number" 
            class="form-control"
            name="slowSpeedsCancel" 
            id="slowSpeedsCancel"
          >
        </div>
        <div class="col-md-6">
          <label for="notConsistent" class="form-label">Not consistent enough</label>
          <input 
            type="number" 
            class="form-control"
            name="notConsistent"
            id="notConsistent"
          >
        </div>
        <div class="col-md-6">
          <label for="noLongerNeeded" class="form-label">No longer needed</label>
          <input 
            type="number" 
            class="form-control"
            name="noLongerNeeded"
            id="noLongerNeeded"
          >
        </div>
        <div class="col-md-6">
          <label for="customerService" class="form-label">Customer service</label>
          <input 
            type="number" 
            class="form-control"
            name="customerService"
            id="customerService"
          >
        </div>
        <div class="col-md-6">
          <label for="tooExpensive" class="form-label">Too Expensive</label>
          <input 
            type="number" 
            class="form-control"
            name="tooExpensive"
            id="tooExpensive"
          >
        </div>
        <div class="col-md-6">
          <label for="freeTrial" class="form-label">Thought it was a 14 days free trial</label>
          <input 
            type="number" 
            class="form-control"
            name="freeTrial"
            id="freeTrial"
          >
        </div>
        <div class="col-md-6">
          <label for="preOrderCancel" class="form-label">Pre Order cancelation</label>
          <input 
            type="number" 
            class="form-control"
            name="preOrderCancel"
            id="preOrderCancel"
          >
        </div>
      </div>

      <hr class="my-4">

      <!-- Shipping Delay Chats -->
      <h5 class="mb-3">Shipping Delay Chats</h5>
      <div class="mb-3">
        <label for="shippingDelay" class="form-label">Shipping Delay Chats</label>
        <input 
          type="number" 
          class="form-control" 
          name="shippingDelay" 
          id="shippingDelay"
        >
      </div>

      <div class="d-grid mt-4">
        <button type="submit" class="btn btn-primary btn-lg">Submit</button>
      </div>
    </form>
    <!-- FORM END -->

    <!-- REPORT SECTION -->
    <div id="reportSection" class="mt-5 fade-in" style="display: none;">
      <h2>Submission Summary</h2>
      <div id="reportContent" class="p-3 bg-white rounded"></div>
    </div>
  </div>


  <!-- Bootstrap JS (for some components if needed) -->
  <script 
    src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js">
  </script>

  <script>
    const scriptURL = 'https://script.google.com/macros/s/AKfycbzlMG6gJgiPRFbTSqM4b4O8MEQebOV2sRfLf0gJ1sCBlaRfxy4khV2YWKOG8mD7zwFsBA/exec'; // <-- REPLACE WITH YOUR DEPLOYED WEB APP URL

    const form = document.getElementById('chatForm');
    const reportSection = document.getElementById('reportSection');
    const reportContent = document.getElementById('reportContent');

    form.addEventListener('submit', async (e) => {
      e.preventDefault();

      // Create a FormData object from the form
      const formData = new FormData(form);

      // Convert FormData to a plain object for fetch
      let plainFormData = {};
      formData.forEach((value, key) => {
        plainFormData[key] = value;
      });

      // Submit to Apps Script using fetch
      try {
        const response = await fetch(scriptURL, {
          method: 'POST',
          mode: 'cors',
          headers: {
            'Content-Type': 'application/x-www-form-urlencoded'
          },
          body: new URLSearchParams(plainFormData).toString()
        });
        const json = await response.json();

        if (json.result === 'success') {
          // Show a confirmation message + summary
          showReport(plainFormData);
          // Optionally, reset the form
          form.reset();
        } else {
          alert("Something went wrong: " + JSON.stringify(json.error));
        }

      } catch (err) {
        alert("Error submitting form: " + err.toString());
      }
    });

    function showReport(data) {
      // Build a quick summary HTML from the form data
      const summaryHtml = `
        <p><strong>Agent Name:</strong> ${data.agentName}</p>
        <p><strong>Date & Hour (CST):</strong> ${data.dateHour}</p>
        <p><strong>Total Number of Chats:</strong> ${data.totalChats}</p>
        
        <h5>Billing</h5>
        <ul>
          <li>Billing Total Chats: ${data.billingTotal}</li>
          <li>Charged After Cancellation: ${data.chargedAfterCancelation}</li>
          <li>With 14 days MBG: ${data.with14DaysMBG}</li>
          <li>Add-ons/extra charges: ${data.addOnsExtraCharges}</li>
          <li>Wanting to pay their bill: ${data.wantingToPayBill}</li>
          <li>Extensions: ${data.extensions}</li>
        </ul>

        <h5>Tech</h5>
        <ul>
          <li>Tech Total Chats: ${data.techTotal}</li>
          <li>Activation: ${data.activation}</li>
          <li>Slow speeds: ${data.slowSpeeds}</li>
          <li>Internet stopping out of nowhere: ${data.internetStopping}</li>
          <li>Internet not working after resuming service: ${data.notWorkingAfterResume}</li>
          <li>Replacements (replacement activation): ${data.replacements}</li>
        </ul>

        <h5>Cancelation</h5>
        <ul>
          <li>Cancelation Total Chats: ${data.cancelTotal}</li>
          <li>Found another provider: ${data.foundAnother}</li>
          <li>Slow speeds: ${data.slowSpeedsCancel}</li>
          <li>Not consistent enough: ${data.notConsistent}</li>
          <li>No longer needed: ${data.noLongerNeeded}</li>
          <li>Customer service: ${data.customerService}</li>
          <li>Too Expensive: ${data.tooExpensive}</li>
          <li>Thought it was 14 days free trial: ${data.freeTrial}</li>
          <li>Pre Order cancelation: ${data.preOrderCancel}</li>
        </ul>

        <h5>Shipping Delay Chats</h5>
        <ul>
          <li>Shipping Delay: ${data.shippingDelay}</li>
        </ul>
      `;

      reportContent.innerHTML = summaryHtml;
      reportSection.style.display = 'block';
      reportSection.scrollIntoView({ behavior: 'smooth' });
    }
  </script>
</body>
</html>
