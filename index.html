<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Agent Chat Reporting</title>
  
  <!-- Bootstrap 5 CSS -->
  <link 
    href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" 
    rel="stylesheet"
  >
  
  <style>
    body {
      background-color: #f8f9fa;
    }
    .hidden {
      display: none !important;
    }
  </style>
</head>
<body>

<div class="container my-5">
  <h1 class="text-center mb-4">Agent Chat Reporting Form</h1>

  <form id="reportForm" class="row g-3">
    <!-- Agent Name -->
    <div class="col-12">
      <label for="agentName" class="form-label fw-bold">Name of the Agent</label>
      <select id="agentName" class="form-select" required>
        <option value="">-- Select Agent --</option>
        <option value="Agent 1">Ahmed</option>
        <option value="Agent 2">Sam</option>
        <option value="Agent 3">Rayyan</option>
        <option value="Agent 4">Max</option>
        <option value="Agent 5">Justin</option>
        <option value="Agent 6">Mark</option>
        <option value="Agent 7">Donald</option>
        <option value="Agent 8">Danial</option>
        <option value="Agent 9">Agent 9</option>
        <option value="Agent 10">Agent 10</option>
        <option value="Agent 11">Agent 11</option>
        <option value="Agent 12">Agent 12</option>
      </select>
    </div>

    <!-- Date and Hour (CST) -->
    <div class="col-md-6">
      <label for="dateTime" class="form-label fw-bold">Date &amp; Hour (CST)</label>
      <input type="datetime-local" id="dateTime" class="form-control" required />
    </div>

    <!-- Total Chats -->
    <div class="col-md-6">
      <label for="totalChats" class="form-label fw-bold">Total Number of Chats</label>
      <input type="number" id="totalChats" class="form-control" min="0" required />
    </div>

    <!-- Billing Category (Card) -->
    <div class="col-12">
      <div class="card mt-3">
        <div class="card-header bg-primary text-white">
          <strong>Billing Category</strong>
        </div>
        <div class="card-body row g-3">
          <div class="col-md-4">
            <label for="billingTotal" class="form-label">Billing - Total Chats</label>
            <input type="number" id="billingTotal" class="form-control" min="0" value="0" required>
          </div>
          <div class="col-md-4">
            <label for="chargedAfterCancelation" class="form-label">Charged After Cancelation</label>
            <input type="number" id="chargedAfterCancelation" class="form-control" min="0" value="0">
          </div>
          <div class="col-md-4">
            <label for="with14DaysMBG" class="form-label">With 14 Days MBG</label>
            <input type="number" id="with14DaysMBG" class="form-control" min="0" value="0">
          </div>
          <div class="col-md-4">
            <label for="addOnsExtraCharges" class="form-label">Add-ons/Extra Charges</label>
            <input type="number" id="addOnsExtraCharges" class="form-control" min="0" value="0">
          </div>
          <div class="col-md-4">
            <label for="wantingToPayBill" class="form-label">Wanting to Pay Their Bill</label>
            <input type="number" id="wantingToPayBill" class="form-control" min="0" value="0">
          </div>
          <div class="col-md-4">
            <label for="extensions" class="form-label">Extensions</label>
            <input type="number" id="extensions" class="form-control" min="0" value="0">
          </div>
        </div>
      </div>
    </div>

    <!-- Tech Category (Card) -->
    <div class="col-12">
      <div class="card mt-3">
        <div class="card-header bg-success text-white">
          <strong>Tech Category</strong>
        </div>
        <div class="card-body row g-3">
          <div class="col-md-4">
            <label for="techTotal" class="form-label">Tech - Total Chats</label>
            <input type="number" id="techTotal" class="form-control" min="0" value="0" required>
          </div>
          <div class="col-md-4">
            <label for="activation" class="form-label">Activation</label>
            <input type="number" id="activation" class="form-control" min="0" value="0">
          </div>
          <div class="col-md-4">
            <label for="slowSpeeds" class="form-label">Slow Speeds</label>
            <input type="number" id="slowSpeeds" class="form-control" min="0" value="0">
          </div>
          <div class="col-md-4">
            <label for="internetStopping" class="form-label">Internet Stopping Out of Nowhere</label>
            <input type="number" id="internetStopping" class="form-control" min="0" value="0">
          </div>
          <div class="col-md-4">
            <label for="internetNotWorkingResume" class="form-label">Internet Not Working (After Resume)</label>
            <input type="number" id="internetNotWorkingResume" class="form-control" min="0" value="0">
          </div>
          <div class="col-md-4">
            <label for="replacements" class="form-label">Replacements (Activation)</label>
            <input type="number" id="replacements" class="form-control" min="0" value="0">
          </div>
        </div>
      </div>
    </div>

    <!-- Cancelation Category (Card) -->
    <div class="col-12">
      <div class="card mt-3">
        <div class="card-header bg-warning">
          <strong>Cancelation Category</strong>
        </div>
        <div class="card-body row g-3">
          <div class="col-md-4">
            <label for="cancellationTotal" class="form-label">Cancelation - Total Chats</label>
            <input type="number" id="cancellationTotal" class="form-control" min="0" value="0" required>
          </div>
          <div class="col-md-4">
            <label for="foundAnotherProvider" class="form-label">Found Another Provider</label>
            <input type="number" id="foundAnotherProvider" class="form-control" min="0" value="0">
          </div>
          <div class="col-md-4">
            <label for="cancelSlowSpeeds" class="form-label">Slow Speeds (Cancel)</label>
            <input type="number" id="cancelSlowSpeeds" class="form-control" min="0" value="0">
          </div>
          <div class="col-md-4">
            <label for="notConsistentEnough" class="form-label">Not Consistent Enough</label>
            <input type="number" id="notConsistentEnough" class="form-control" min="0" value="0">
          </div>
          <div class="col-md-4">
            <label for="noLongerNeeded" class="form-label">No Longer Needed</label>
            <input type="number" id="noLongerNeeded" class="form-control" min="0" value="0">
          </div>
          <div class="col-md-4">
            <label for="customerService" class="form-label">Customer Service</label>
            <input type="number" id="customerService" class="form-control" min="0" value="0">
          </div>
          <div class="col-md-4">
            <label for="tooExpensive" class="form-label">Too Expensive</label>
            <input type="number" id="tooExpensive" class="form-control" min="0" value="0">
          </div>
          <div class="col-md-4">
            <label for="freeTrialMisunderstanding" class="form-label">Thought it was a 14 Days Free Trial</label>
            <input type="number" id="freeTrialMisunderstanding" class="form-control" min="0" value="0">
          </div>
          <div class="col-md-4">
            <label for="preOrderCancel" class="form-label">Pre-Order Cancelation</label>
            <input type="number" id="preOrderCancel" class="form-control" min="0" value="0">
          </div>
        </div>
      </div>
    </div>

    <!-- Shipping Delay -->
    <div class="col-12">
      <div class="card mt-3">
        <div class="card-header bg-info">
          <strong>Shipping Delay</strong>
        </div>
        <div class="card-body">
          <label for="shippingDelay" class="form-label">Shipping Delay Chats</label>
          <input type="number" id="shippingDelay" class="form-control" min="0" value="0">
        </div>
      </div>
    </div>

    <!-- SUBMIT BUTTON -->
    <div class="col-12 text-center mt-4">
      <button type="submit" class="btn btn-lg btn-primary">Submit</button>
    </div>
  </form>

  <!-- The final "report" or summary after submission -->
  <div id="submissionReport" class="hidden mt-5">
    <div class="card">
      <div class="card-header bg-secondary text-white">
        <strong>Submission Summary</strong>
      </div>
      <div class="card-body">
        <div id="summaryContent" class="mb-3"></div>
        <p class="fw-semibold">Please post this summary in the CS channel.</p>
        <button id="newResponseBtn" class="btn btn-outline-secondary">Submit Another Response</button>
      </div>
    </div>
  </div>
</div><!-- /.container -->

<!-- Replace this with your actual Web App URL from Google Apps Script -->
<script>
  const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbzsUu4IVxQ9HFubqa38S66kyDOvLed7ypDqWVwfGiz6C315e4Ttf9vY8i-TV1Dm9obc/exec";

  const reportForm = document.getElementById("reportForm");
  const submissionReport = document.getElementById("submissionReport");
  const summaryContent = document.getElementById("summaryContent");
  const newResponseBtn = document.getElementById("newResponseBtn");

  reportForm.addEventListener("submit", function(e) {
    e.preventDefault();

    // Gather form data
    const formData = {
      agentName: document.getElementById("agentName").value,
      dateTime: document.getElementById("dateTime").value,
      totalChats: document.getElementById("totalChats").value,
      
      // Billing
      billingTotal: document.getElementById("billingTotal").value,
      chargedAfterCancelation: document.getElementById("chargedAfterCancelation").value,
      with14DaysMBG: document.getElementById("with14DaysMBG").value,
      addOnsExtraCharges: document.getElementById("addOnsExtraCharges").value,
      wantingToPayBill: document.getElementById("wantingToPayBill").value,
      extensions: document.getElementById("extensions").value,
      
      // Tech
      techTotal: document.getElementById("techTotal").value,
      activation: document.getElementById("activation").value,
      slowSpeeds: document.getElementById("slowSpeeds").value,
      internetStopping: document.getElementById("internetStopping").value,
      internetNotWorkingResume: document.getElementById("internetNotWorkingResume").value,
      replacements: document.getElementById("replacements").value,
      
      // Cancellation
      cancellationTotal: document.getElementById("cancellationTotal").value,
      foundAnotherProvider: document.getElementById("foundAnotherProvider").value,
      cancelSlowSpeeds: document.getElementById("cancelSlowSpeeds").value,
      notConsistentEnough: document.getElementById("notConsistentEnough").value,
      noLongerNeeded: document.getElementById("noLongerNeeded").value,
      customerService: document.getElementById("customerService").value,
      tooExpensive: document.getElementById("tooExpensive").value,
      freeTrialMisunderstanding: document.getElementById("freeTrialMisunderstanding").value,
      preOrderCancel: document.getElementById("preOrderCancel").value,

      // Shipping Delay
      shippingDelay: document.getElementById("shippingDelay").value
    };

    // POST to Google Apps Script
   

      fetch(SCRIPT_URL, {
  method: 'POST',
  mode: 'no-cors',
  body: JSON.stringify(formData),
  headers: { 'Content-Type': 'application/json' },
});
    .then(res => res.json())
    .then(response => {
      if (response.status === "success") {
        // Build summary
        let summaryHtml = `
          <ul class="list-group">
            <li class="list-group-item"><strong>Agent Name:</strong> ${formData.agentName}</li>
            <li class="list-group-item"><strong>Date & Hour (CST):</strong> ${formData.dateTime}</li>
            <li class="list-group-item"><strong>Total Chats:</strong> ${formData.totalChats}</li>
            <li class="list-group-item"><strong>Billing Total:</strong> ${formData.billingTotal}</li>
            <li class="list-group-item"><strong>Tech Total:</strong> ${formData.techTotal}</li>
            <li class="list-group-item"><strong>Cancellation Total:</strong> ${formData.cancellationTotal}</li>
            <li class="list-group-item"><strong>Shipping Delay:</strong> ${formData.shippingDelay}</li>
          </ul>
          <p class="mt-3 mb-0">(Full breakdown is in the Google Sheet!)</p>
        `;

        summaryContent.innerHTML = summaryHtml;
        submissionReport.classList.remove("hidden");

        // Hide the form
        reportForm.classList.add("hidden");
        
      } else {
        alert("Error submitting data: " + (response.message || "Unknown error"));
      }
    })
    .catch(err => {
      alert("Something went wrong. " + err);
      console.error(err);
    });
  });

  // Reset form to submit another response
  newResponseBtn.addEventListener("click", function() {
    // Show the form again
    reportForm.classList.remove("hidden");
    // Hide the summary
    submissionReport.classList.add("hidden");
    // Reset form fields
    reportForm.reset();
  });
</script>

<!-- Bootstrap 5 JS (Optional, for any interactive Bootstrap components) -->
<script 
  src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js">
</script>

</body>
</html>


