<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Hourly Reporting Form</title>
  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
  <style>
    /* Position counters at bottom right of each card */
    .section-counter {
      position: absolute;
      bottom: 10px;
      right: 10px;
      font-weight: bold;
    }
    /* Ensure cards have relative positioning for counter placement */
    .card {
      position: relative;
    }
  </style>
</head>
<body>
  <div class="container my-5">
    <h1 class="text-center mb-4">Hourly Reporting Form</h1>
    <form id="myForm" action="https://script.google.com/macros/s/YOUR_SCRIPT_ID_HERE/exec" method="post">

      <!-- Agent Selection and Date/Hour -->
      <div class="row g-3 mb-4">
        <div class="col-md-4">
          <label for="agentName" class="form-label">Name of the Agent:</label>
          <select class="form-select" id="agentName" name="agentName" required>
            <option value="">Select an agent...</option>
            <option value="Agent1">Agent1</option>
            <option value="Agent2">Agent2</option>
            <option value="Agent3">Agent3</option>
            <option value="Agent4">Agent4</option>
            <option value="Agent5">Agent5</option>
            <option value="Agent6">Agent6</option>
            <option value="Agent7">Agent7</option>
            <option value="Agent8">Agent8</option>
            <option value="Agent9">Agent9</option>
            <option value="Agent10">Agent10</option>
            <option value="Agent11">Agent11</option>
            <option value="Agent12">Agent12</option>
            <option value="Agent13">Agent13</option>
            <option value="Agent14">Agent14</option>
            <option value="Agent15">Agent15</option>
          </select>
        </div>
        <div class="col-md-4">
          <label for="reportDate" class="form-label">Date:</label>
          <input type="date" class="form-control" id="reportDate" name="reportDate" required />
        </div>
        <div class="col-md-4">
          <label for="hour" class="form-label">Hour of the Day (CST):</label>
          <select class="form-select" id="hour" name="hour" required>
            <option value="">Select hour...</option>
            <option value="00:00">00:00</option>
            <option value="01:00">01:00</option>
            <option value="02:00">02:00</option>
            <option value="03:00">03:00</option>
            <option value="04:00">04:00</option>
            <option value="05:00">05:00</option>
            <option value="06:00">06:00</option>
            <option value="07:00">07:00</option>
            <option value="08:00">08:00</option>
            <option value="09:00">09:00</option>
            <option value="10:00">10:00</option>
            <option value="11:00">11:00</option>
            <option value="12:00">12:00</option>
            <option value="13:00">13:00</option>
            <option value="14:00">14:00</option>
            <option value="15:00">15:00</option>
            <option value="16:00">16:00</option>
            <option value="17:00">17:00</option>
            <option value="18:00">18:00</option>
            <option value="19:00">19:00</option>
            <option value="20:00">20:00</option>
            <option value="21:00">21:00</option>
            <option value="22:00">22:00</option>
            <option value="23:00">23:00</option>
          </select>
        </div>
      </div>

      <!-- Automatically Calculated Total Chats -->
      <div class="mb-4">
        <label for="totalChats" class="form-label">Total Number of Chats:</label>
        <input type="number" class="form-control" id="totalChats" name="totalChats" readonly />
      </div>

      <!-- Billing Category -->
      <div class="card mb-4">
        <div class="card-header">Billing Total Chats</div>
        <div class="card-body">
          <div class="mb-3">
            <label class="form-label">Billing Total Chats:</label>
            <div id="input_billingTotal"></div>
          </div>
          <div class="row g-3">
            <div class="col-md-6">
              <label class="form-label">Charged after cancellation:</label>
              <div id="input_chargedAfterCancelation"></div>
            </div>
            <div class="col-md-6">
              <label class="form-label">With 14 days MBG:</label>
              <div id="input_with14DaysMBG"></div>
            </div>
          </div>
          <div class="row g-3 mt-3">
            <div class="col-md-4">
              <label class="form-label">Add-ons/extra charges:</label>
              <div id="input_addOnsExtraCharges"></div>
            </div>
            <div class="col-md-4">
              <label class="form-label">Wanting to pay their bill:</label>
              <div id="input_wantingToPayBill"></div>
            </div>
            <div class="col-md-4">
              <label class="form-label">Extensions:</label>
              <div id="input_extensions"></div>
            </div>
          </div>
        </div>
        <div class="section-counter" id="billingCounter">Section Total: 0</div>
      </div>

      <!-- Tech Category -->
      <div class="card mb-4">
        <div class="card-header">Tech Total Chats</div>
        <div class="card-body">
          <div class="mb-3">
            <label class="form-label">Tech Total Chats:</label>
            <div id="input_techTotalChats"></div>
          </div>
          <h5>Subcategories</h5>
          <div class="row g-3">
            <div class="col-md-4">
              <label class="form-label">Activation:</label>
              <div id="input_activation"></div>
            </div>
            <div class="col-md-4">
              <label class="form-label">Slow speeds:</label>
              <div id="input_slowSpeeds"></div>
            </div>
            <div class="col-md-4">
              <label class="form-label">Internet stopping out of nowhere:</label>
              <div id="input_internetStopping"></div>
            </div>
          </div>
          <div class="row g-3 mt-3">
            <div class="col-md-4">
              <label class="form-label">Internet not working after resuming service:</label>
              <div id="input_notWorkingAfterResuming"></div>
            </div>
            <div class="col-md-4">
              <label class="form-label">Replacements (replacement activation):</label>
              <div id="input_replacements"></div>
            </div>
          </div>
        </div>
        <div class="section-counter" id="techCounter">Section Total: 0</div>
      </div>

      <!-- Cancellation Category -->
      <div class="card mb-4">
        <div class="card-header">Cancellation Total Chats</div>
        <div class="card-body">
          <div class="mb-3">
            <label class="form-label">Cancellation Total Chats:</label>
            <div id="input_cancellationTotalChats"></div>
          </div>
          <div class="row g-3">
            <div class="col-md-4">
              <label class="form-label">Found another provider:</label>
              <div id="input_foundAnotherProvider"></div>
            </div>
            <div class="col-md-4">
              <label class="form-label">Slow speeds:</label>
              <div id="input_slowSpeedsCancel"></div>
            </div>
            <div class="col-md-4">
              <label class="form-label">Not consistent enough:</label>
              <div id="input_notConsistentEnough"></div>
            </div>
          </div>
          <div class="row g-3 mt-3">
            <div class="col-md-4">
              <label class="form-label">No longer needed:</label>
              <div id="input_noLongerNeeded"></div>
            </div>
            <div class="col-md-4">
              <label class="form-label">Customer service:</label>
              <div id="input_customerService"></div>
            </div>
            <div class="col-md-4">
              <label class="form-label">Too Expensive:</label>
              <div id="input_tooExpensive"></div>
            </div>
          </div>
          <div class="row g-3 mt-3">
            <div class="col-md-4">
              <label class="form-label">Thought it was a 14 days free trial:</label>
              <div id="input_thought14DaysFreeTrial"></div>
            </div>
            <div class="col-md-4">
              <label class="form-label">Pre Order cancellation:</label>
              <div id="input_preOrderCancellation"></div>
            </div>
            <div class="col-md-4">
              <label class="form-label">Shipping delay chats:</label>
              <div id="input_shippingDelayChats"></div>
            </div>
          </div>
        </div>
        <div class="section-counter" id="cancelCounter">Section Total: 0</div>
      </div>

      <button type="submit" class="btn btn-primary">Submit</button>
    </form>
  </div>

  <!-- Bootstrap Modal for Submission Summary -->
  <div class="modal fade" id="reportModal" tabindex="-1" aria-labelledby="reportModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="reportModalLabel">Submission Summary</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body" id="modalSummary"></div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Submit Another Response</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Bootstrap JS Bundle -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  <script src="index.js"></script>
</body>
</html>
